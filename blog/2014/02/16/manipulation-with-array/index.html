
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Манипуляции с массивами - xgrommx's blog</title>
  <meta name="author" content="Денис Стоянов">

  
  <meta name="description" content="Довольно часто нам приходится фильтровать, изменять или приводить все элементы к единому скалярному значению. Иногда это является довольно рутинной &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://xgrommx.github.io/blog/2014/02/16/manipulation-with-array">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="xgrommx's blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">xgrommx's blog</a></h1>
  
    <h2>Просто о сложном.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:xgrommx.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Манипуляции с массивами</h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-02-16T13:53:32+02:00" pubdate data-updated="true">Feb 16<span>th</span>, 2014</time>
        
           | <a href="#disqus_thread"
             data-disqus-identifier="http://xgrommx.github.io">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>Довольно часто нам приходится фильтровать, изменять или приводить все элементы к единому скалярному значению. Иногда это является довольно рутинной задачей и делает некоторые сложности. На помощь нам может прийти три основных понятия функционального программирования, на котором оно основано.</p>

<p>Допустим у нас есть массив с юзерами у которых есть имя, фамилия, возраст, пол и размер оклада заработной платы. Припустим, что нам надо получить только лишь имена.</p>

<!-- more -->

<p>С помощью обычного императивного подхода это будет выглядить так:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
</pre></td><td class="code"><pre><code class="js"><span class="line"><span class="kd">var</span> <span class="nx">users</span> <span class="o">=</span> <span class="p">[</span>
</span><span class="line">    <span class="p">{</span><span class="nx">firstName</span><span class="o">:</span> <span class="s1">&#39;Алексей&#39;</span><span class="p">,</span> <span class="nx">lastName</span><span class="o">:</span> <span class="s1">&#39;Алексеев&#39;</span><span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">25</span><span class="p">,</span> <span class="nx">sex</span><span class="o">:</span> <span class="s1">&#39;male&#39;</span><span class="p">,</span> <span class="nx">salary</span><span class="o">:</span> <span class="mi">10000</span><span class="p">},</span>
</span><span class="line">    <span class="p">{</span><span class="nx">firstName</span><span class="o">:</span> <span class="s1">&#39;Петр&#39;</span><span class="p">,</span> <span class="nx">lastName</span><span class="o">:</span> <span class="s1">&#39;Петров&#39;</span><span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">30</span><span class="p">,</span> <span class="nx">sex</span><span class="o">:</span> <span class="s1">&#39;male&#39;</span><span class="p">,</span> <span class="nx">salary</span><span class="o">:</span> <span class="mi">18000</span><span class="p">},</span>
</span><span class="line">    <span class="p">{</span><span class="nx">firstName</span><span class="o">:</span> <span class="s1">&#39;Марина&#39;</span><span class="p">,</span> <span class="nx">lastName</span><span class="o">:</span> <span class="s1">&#39;Алексеевна&#39;</span><span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">26</span><span class="p">,</span> <span class="nx">sex</span><span class="o">:</span> <span class="s1">&#39;female&#39;</span><span class="p">,</span> <span class="nx">salary</span><span class="o">:</span> <span class="mi">8000</span><span class="p">},</span>
</span><span class="line">    <span class="p">{</span><span class="nx">firstName</span><span class="o">:</span> <span class="s1">&#39;Ольга&#39;</span><span class="p">,</span> <span class="nx">lastName</span><span class="o">:</span> <span class="s1">&#39;Петровна&#39;</span><span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">45</span><span class="p">,</span> <span class="nx">sex</span><span class="o">:</span> <span class="s1">&#39;female&#39;</span><span class="p">,</span> <span class="nx">salary</span><span class="o">:</span> <span class="mi">19000</span><span class="p">},</span>
</span><span class="line">    <span class="p">{</span><span class="nx">firstName</span><span class="o">:</span> <span class="s1">&#39;Игорь&#39;</span><span class="p">,</span> <span class="nx">lastName</span><span class="o">:</span> <span class="s1">&#39;Васильев&#39;</span><span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">22</span><span class="p">,</span> <span class="nx">sex</span><span class="o">:</span> <span class="s1">&#39;male&#39;</span><span class="p">,</span> <span class="nx">salary</span><span class="o">:</span> <span class="mi">6000</span><span class="p">}</span>
</span><span class="line"><span class="p">];</span>
</span><span class="line">
</span><span class="line"><span class="kd">var</span> <span class="nx">names</span> <span class="o">=</span> <span class="p">[];</span>
</span><span class="line">
</span><span class="line"><span class="nx">users</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">a</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">    <span class="nx">names</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">el</span><span class="p">.</span><span class="nx">firstName</span><span class="p">);</span>
</span><span class="line"><span class="p">});</span>
</span><span class="line">
</span><span class="line"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">names</span><span class="p">);</span> <span class="c1">// =&gt; [&quot;Алексей&quot;, &quot;Петр&quot;, &quot;Марина&quot;, &quot;Ольга&quot;, &quot;Игорь&quot;] </span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Чтоже выглядит довольно не плохо, но есть одно но. Почему бы сразу из текущего массива не получить новый, путем его проекции? На помощь к нам приходит метод <code>map</code>. Он служит своего рода как функция-проектор, которая в зависимости от колбека создает новую проекцию текущего массива. Давайте перепишем наш код:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
</pre></td><td class="code"><pre><code class="js"><span class="line"><span class="kd">var</span> <span class="nx">users</span> <span class="o">=</span> <span class="p">[</span>
</span><span class="line">    <span class="p">{</span><span class="nx">firstName</span><span class="o">:</span> <span class="s1">&#39;Алексей&#39;</span><span class="p">,</span> <span class="nx">lastName</span><span class="o">:</span> <span class="s1">&#39;Алексеев&#39;</span><span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">25</span><span class="p">,</span> <span class="nx">sex</span><span class="o">:</span> <span class="s1">&#39;male&#39;</span><span class="p">,</span> <span class="nx">salary</span><span class="o">:</span> <span class="mi">10000</span><span class="p">},</span>
</span><span class="line">    <span class="p">{</span><span class="nx">firstName</span><span class="o">:</span> <span class="s1">&#39;Петр&#39;</span><span class="p">,</span> <span class="nx">lastName</span><span class="o">:</span> <span class="s1">&#39;Петров&#39;</span><span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">30</span><span class="p">,</span> <span class="nx">sex</span><span class="o">:</span> <span class="s1">&#39;male&#39;</span><span class="p">,</span> <span class="nx">salary</span><span class="o">:</span> <span class="mi">18000</span><span class="p">},</span>
</span><span class="line">    <span class="p">{</span><span class="nx">firstName</span><span class="o">:</span> <span class="s1">&#39;Марина&#39;</span><span class="p">,</span> <span class="nx">lastName</span><span class="o">:</span> <span class="s1">&#39;Алексеевна&#39;</span><span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">26</span><span class="p">,</span> <span class="nx">sex</span><span class="o">:</span> <span class="s1">&#39;female&#39;</span><span class="p">,</span> <span class="nx">salary</span><span class="o">:</span> <span class="mi">8000</span><span class="p">},</span>
</span><span class="line">    <span class="p">{</span><span class="nx">firstName</span><span class="o">:</span> <span class="s1">&#39;Ольга&#39;</span><span class="p">,</span> <span class="nx">lastName</span><span class="o">:</span> <span class="s1">&#39;Петровна&#39;</span><span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">45</span><span class="p">,</span> <span class="nx">sex</span><span class="o">:</span> <span class="s1">&#39;female&#39;</span><span class="p">,</span> <span class="nx">salary</span><span class="o">:</span> <span class="mi">19000</span><span class="p">},</span>
</span><span class="line">    <span class="p">{</span><span class="nx">firstName</span><span class="o">:</span> <span class="s1">&#39;Игорь&#39;</span><span class="p">,</span> <span class="nx">lastName</span><span class="o">:</span> <span class="s1">&#39;Васильев&#39;</span><span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">22</span><span class="p">,</span> <span class="nx">sex</span><span class="o">:</span> <span class="s1">&#39;male&#39;</span><span class="p">,</span> <span class="nx">salary</span><span class="o">:</span> <span class="mi">6000</span><span class="p">}</span>
</span><span class="line"><span class="p">];</span>
</span><span class="line">
</span><span class="line"><span class="kd">var</span> <span class="nx">names</span> <span class="o">=</span> <span class="nx">users</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">el</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">    <span class="k">return</span> <span class="nx">el</span><span class="p">.</span><span class="nx">firstName</span><span class="p">;</span>
</span><span class="line"><span class="p">});</span>
</span><span class="line">
</span><span class="line"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">names</span><span class="p">);</span> <span class="c1">// =&gt; [&quot;Алексей&quot;, &quot;Петр&quot;, &quot;Марина&quot;, &quot;Ольга&quot;, &quot;Игорь&quot;]</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Как можно заметить, что функция-проектор, которая используется как колбек у <code>map</code> применится к каждому из элементов этого массива и вернет новый массив с изменнеными значениями. Это можно увидеть на этой диаграмме:</p>

<p><img src="https://github.com/Netflix/RxJava/wiki/images/rx-operators/map.png" alt="Array map" /></p>

<p>Довольно не плохо, скажете вы, но что делать если мы хотим получить только мужчин или же только тех у кого присутствует буква “A”. Как и раньше давайте снова напишем в старом и стиле и проверим как это будет работать.</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
</pre></td><td class="code"><pre><code class="js"><span class="line"><span class="kd">var</span> <span class="nx">users</span> <span class="o">=</span> <span class="p">[</span>
</span><span class="line">    <span class="p">{</span><span class="nx">firstName</span><span class="o">:</span> <span class="s1">&#39;Алексей&#39;</span><span class="p">,</span> <span class="nx">lastName</span><span class="o">:</span> <span class="s1">&#39;Алексеев&#39;</span><span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">25</span><span class="p">,</span> <span class="nx">sex</span><span class="o">:</span> <span class="s1">&#39;male&#39;</span><span class="p">,</span> <span class="nx">salary</span><span class="o">:</span> <span class="mi">10000</span><span class="p">},</span>
</span><span class="line">    <span class="p">{</span><span class="nx">firstName</span><span class="o">:</span> <span class="s1">&#39;Петр&#39;</span><span class="p">,</span> <span class="nx">lastName</span><span class="o">:</span> <span class="s1">&#39;Петров&#39;</span><span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">30</span><span class="p">,</span> <span class="nx">sex</span><span class="o">:</span> <span class="s1">&#39;male&#39;</span><span class="p">,</span> <span class="nx">salary</span><span class="o">:</span> <span class="mi">18000</span><span class="p">},</span>
</span><span class="line">    <span class="p">{</span><span class="nx">firstName</span><span class="o">:</span> <span class="s1">&#39;Марина&#39;</span><span class="p">,</span> <span class="nx">lastName</span><span class="o">:</span> <span class="s1">&#39;Алексеевна&#39;</span><span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">26</span><span class="p">,</span> <span class="nx">sex</span><span class="o">:</span> <span class="s1">&#39;female&#39;</span><span class="p">,</span> <span class="nx">salary</span><span class="o">:</span> <span class="mi">8000</span><span class="p">},</span>
</span><span class="line">    <span class="p">{</span><span class="nx">firstName</span><span class="o">:</span> <span class="s1">&#39;Ольга&#39;</span><span class="p">,</span> <span class="nx">lastName</span><span class="o">:</span> <span class="s1">&#39;Петровна&#39;</span><span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">45</span><span class="p">,</span> <span class="nx">sex</span><span class="o">:</span> <span class="s1">&#39;female&#39;</span><span class="p">,</span> <span class="nx">salary</span><span class="o">:</span> <span class="mi">19000</span><span class="p">},</span>
</span><span class="line">    <span class="p">{</span><span class="nx">firstName</span><span class="o">:</span> <span class="s1">&#39;Игорь&#39;</span><span class="p">,</span> <span class="nx">lastName</span><span class="o">:</span> <span class="s1">&#39;Васильев&#39;</span><span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">22</span><span class="p">,</span> <span class="nx">sex</span><span class="o">:</span> <span class="s1">&#39;male&#39;</span><span class="p">,</span> <span class="nx">salary</span><span class="o">:</span> <span class="mi">6000</span><span class="p">}</span>
</span><span class="line"><span class="p">];</span>
</span><span class="line">
</span><span class="line"><span class="kd">var</span> <span class="nx">onlyMale</span> <span class="o">=</span> <span class="p">[];</span>
</span><span class="line">
</span><span class="line"><span class="nx">users</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">a</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">    <span class="k">if</span><span class="p">(</span><span class="nx">el</span><span class="p">.</span><span class="nx">sex</span> <span class="o">===</span> <span class="s1">&#39;male&#39;</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">        <span class="nx">onlyMale</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">el</span><span class="p">);</span>
</span><span class="line">    <span class="p">}</span>
</span><span class="line"><span class="p">});</span>
</span><span class="line">
</span><span class="line"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">onlyMale</span><span class="p">);</span> <span class="c1">// =&gt; [Object, Object, Object]</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Чтоже наша сильная половина человечества отфильтрована. Но как и с случаем с <code>map</code> мы бы хотели просто получить новый массив, не проводя никаких итераций. И тут нам на помощь приходит функция <code>filter</code> у которой есть специализированный колбек - предикат. Предикат - это функция, коротая возвращет всего два значения (<code>true</code> или <code>false</code>) тоесть булевые значения.</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
</pre></td><td class="code"><pre><code class="js"><span class="line"><span class="kd">var</span> <span class="nx">users</span> <span class="o">=</span> <span class="p">[</span>
</span><span class="line">    <span class="p">{</span><span class="nx">firstName</span><span class="o">:</span> <span class="s1">&#39;Алексей&#39;</span><span class="p">,</span> <span class="nx">lastName</span><span class="o">:</span> <span class="s1">&#39;Алексеев&#39;</span><span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">25</span><span class="p">,</span> <span class="nx">sex</span><span class="o">:</span> <span class="s1">&#39;male&#39;</span><span class="p">,</span> <span class="nx">salary</span><span class="o">:</span> <span class="mi">10000</span><span class="p">},</span>
</span><span class="line">    <span class="p">{</span><span class="nx">firstName</span><span class="o">:</span> <span class="s1">&#39;Петр&#39;</span><span class="p">,</span> <span class="nx">lastName</span><span class="o">:</span> <span class="s1">&#39;Петров&#39;</span><span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">30</span><span class="p">,</span> <span class="nx">sex</span><span class="o">:</span> <span class="s1">&#39;male&#39;</span><span class="p">,</span> <span class="nx">salary</span><span class="o">:</span> <span class="mi">18000</span><span class="p">},</span>
</span><span class="line">    <span class="p">{</span><span class="nx">firstName</span><span class="o">:</span> <span class="s1">&#39;Марина&#39;</span><span class="p">,</span> <span class="nx">lastName</span><span class="o">:</span> <span class="s1">&#39;Алексеевна&#39;</span><span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">26</span><span class="p">,</span> <span class="nx">sex</span><span class="o">:</span> <span class="s1">&#39;female&#39;</span><span class="p">,</span> <span class="nx">salary</span><span class="o">:</span> <span class="mi">8000</span><span class="p">},</span>
</span><span class="line">    <span class="p">{</span><span class="nx">firstName</span><span class="o">:</span> <span class="s1">&#39;Ольга&#39;</span><span class="p">,</span> <span class="nx">lastName</span><span class="o">:</span> <span class="s1">&#39;Петровна&#39;</span><span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">45</span><span class="p">,</span> <span class="nx">sex</span><span class="o">:</span> <span class="s1">&#39;female&#39;</span><span class="p">,</span> <span class="nx">salary</span><span class="o">:</span> <span class="mi">19000</span><span class="p">},</span>
</span><span class="line">    <span class="p">{</span><span class="nx">firstName</span><span class="o">:</span> <span class="s1">&#39;Игорь&#39;</span><span class="p">,</span> <span class="nx">lastName</span><span class="o">:</span> <span class="s1">&#39;Васильев&#39;</span><span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">22</span><span class="p">,</span> <span class="nx">sex</span><span class="o">:</span> <span class="s1">&#39;male&#39;</span><span class="p">,</span> <span class="nx">salary</span><span class="o">:</span> <span class="mi">6000</span><span class="p">}</span>
</span><span class="line"><span class="p">];</span>
</span><span class="line">
</span><span class="line"><span class="kd">var</span> <span class="nx">onlyMale</span> <span class="o">=</span> <span class="nx">users</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">el</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">    <span class="k">return</span> <span class="nx">el</span><span class="p">.</span><span class="nx">sex</span> <span class="o">===</span> <span class="s1">&#39;male&#39;</span><span class="p">;</span>
</span><span class="line"><span class="p">});</span>
</span><span class="line">
</span><span class="line"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">onlyMale</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Сдесь также функция колбек(предикат) применится к каждому элементу массива, но в отличии от <code>map</code>, колличество возвращенных элементов не будет равно колличеству елементов исходного массива. Это происходит потому, что наша функция отбросила все элементы, что не подходили условию. Это также можно увидеть на этой диаграмме.</p>

<p><img src="https://github.com/Netflix/RxJava/wiki/images/rx-operators/filter.png" alt="Array filter" /></p>

<p>Но вдруг возникла задача, что нам нужно привести все элементы массива к одному скалярному значению, например посчитать зарплату всех юзеров. Для этого нам прийдется пройтись по всем элементам массива и агрегировать зарплату всех в одну переменную применяя операцию сложения.</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
</pre></td><td class="code"><pre><code class="js"><span class="line"><span class="kd">var</span> <span class="nx">users</span> <span class="o">=</span> <span class="p">[</span>
</span><span class="line">    <span class="p">{</span><span class="nx">firstName</span><span class="o">:</span> <span class="s1">&#39;Алексей&#39;</span><span class="p">,</span> <span class="nx">lastName</span><span class="o">:</span> <span class="s1">&#39;Алексеев&#39;</span><span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">25</span><span class="p">,</span> <span class="nx">sex</span><span class="o">:</span> <span class="s1">&#39;male&#39;</span><span class="p">,</span> <span class="nx">salary</span><span class="o">:</span> <span class="mi">10000</span><span class="p">},</span>
</span><span class="line">    <span class="p">{</span><span class="nx">firstName</span><span class="o">:</span> <span class="s1">&#39;Петр&#39;</span><span class="p">,</span> <span class="nx">lastName</span><span class="o">:</span> <span class="s1">&#39;Петров&#39;</span><span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">30</span><span class="p">,</span> <span class="nx">sex</span><span class="o">:</span> <span class="s1">&#39;male&#39;</span><span class="p">,</span> <span class="nx">salary</span><span class="o">:</span> <span class="mi">18000</span><span class="p">},</span>
</span><span class="line">    <span class="p">{</span><span class="nx">firstName</span><span class="o">:</span> <span class="s1">&#39;Марина&#39;</span><span class="p">,</span> <span class="nx">lastName</span><span class="o">:</span> <span class="s1">&#39;Алексеевна&#39;</span><span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">26</span><span class="p">,</span> <span class="nx">sex</span><span class="o">:</span> <span class="s1">&#39;female&#39;</span><span class="p">,</span> <span class="nx">salary</span><span class="o">:</span> <span class="mi">8000</span><span class="p">},</span>
</span><span class="line">    <span class="p">{</span><span class="nx">firstName</span><span class="o">:</span> <span class="s1">&#39;Ольга&#39;</span><span class="p">,</span> <span class="nx">lastName</span><span class="o">:</span> <span class="s1">&#39;Петровна&#39;</span><span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">45</span><span class="p">,</span> <span class="nx">sex</span><span class="o">:</span> <span class="s1">&#39;female&#39;</span><span class="p">,</span> <span class="nx">salary</span><span class="o">:</span> <span class="mi">19000</span><span class="p">},</span>
</span><span class="line">    <span class="p">{</span><span class="nx">firstName</span><span class="o">:</span> <span class="s1">&#39;Игорь&#39;</span><span class="p">,</span> <span class="nx">lastName</span><span class="o">:</span> <span class="s1">&#39;Васильев&#39;</span><span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">22</span><span class="p">,</span> <span class="nx">sex</span><span class="o">:</span> <span class="s1">&#39;male&#39;</span><span class="p">,</span> <span class="nx">salary</span><span class="o">:</span> <span class="mi">6000</span><span class="p">}</span>
</span><span class="line"><span class="p">];</span>
</span><span class="line">
</span><span class="line"><span class="kd">var</span> <span class="nx">totalSalary</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class="line">
</span><span class="line"><span class="nx">users</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">a</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">    <span class="nx">totalSalary</span> <span class="o">+=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">el</span><span class="p">.</span><span class="nx">salary</span><span class="p">);</span>
</span><span class="line"><span class="p">});</span>
</span><span class="line">
</span><span class="line"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Total salary = %d&quot;</span><span class="p">,</span> <span class="nx">totalSalary</span><span class="p">);</span> <span class="c1">// =&gt; Total salary = 61000</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Довольно часто приходится менять оператор для агрегации, например использовать умножение или еще какие-то либо другие операторы. Для того чтобы это было довольно просто в арсенале <code>javascript</code> имеется еще один метод - <code>reduce</code>. У него также есть метод колбек, но он принимает в себя два параметра - первый это предидущее значение, а второй текущее. Первый параметр также выступает в роли аккумулятора, который накапливает значения. Теперь наш пример будет выглядить так:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
</pre></td><td class="code"><pre><code class="js"><span class="line"><span class="kd">var</span> <span class="nx">users</span> <span class="o">=</span> <span class="p">[</span>
</span><span class="line">    <span class="p">{</span><span class="nx">firstName</span><span class="o">:</span> <span class="s1">&#39;Алексей&#39;</span><span class="p">,</span> <span class="nx">lastName</span><span class="o">:</span> <span class="s1">&#39;Алексеев&#39;</span><span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">25</span><span class="p">,</span> <span class="nx">sex</span><span class="o">:</span> <span class="s1">&#39;male&#39;</span><span class="p">,</span> <span class="nx">salary</span><span class="o">:</span> <span class="mi">10000</span><span class="p">},</span>
</span><span class="line">    <span class="p">{</span><span class="nx">firstName</span><span class="o">:</span> <span class="s1">&#39;Петр&#39;</span><span class="p">,</span> <span class="nx">lastName</span><span class="o">:</span> <span class="s1">&#39;Петров&#39;</span><span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">30</span><span class="p">,</span> <span class="nx">sex</span><span class="o">:</span> <span class="s1">&#39;male&#39;</span><span class="p">,</span> <span class="nx">salary</span><span class="o">:</span> <span class="mi">18000</span><span class="p">},</span>
</span><span class="line">    <span class="p">{</span><span class="nx">firstName</span><span class="o">:</span> <span class="s1">&#39;Марина&#39;</span><span class="p">,</span> <span class="nx">lastName</span><span class="o">:</span> <span class="s1">&#39;Алексеевна&#39;</span><span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">26</span><span class="p">,</span> <span class="nx">sex</span><span class="o">:</span> <span class="s1">&#39;female&#39;</span><span class="p">,</span> <span class="nx">salary</span><span class="o">:</span> <span class="mi">8000</span><span class="p">},</span>
</span><span class="line">    <span class="p">{</span><span class="nx">firstName</span><span class="o">:</span> <span class="s1">&#39;Ольга&#39;</span><span class="p">,</span> <span class="nx">lastName</span><span class="o">:</span> <span class="s1">&#39;Петровна&#39;</span><span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">45</span><span class="p">,</span> <span class="nx">sex</span><span class="o">:</span> <span class="s1">&#39;female&#39;</span><span class="p">,</span> <span class="nx">salary</span><span class="o">:</span> <span class="mi">19000</span><span class="p">},</span>
</span><span class="line">    <span class="p">{</span><span class="nx">firstName</span><span class="o">:</span> <span class="s1">&#39;Игорь&#39;</span><span class="p">,</span> <span class="nx">lastName</span><span class="o">:</span> <span class="s1">&#39;Васильев&#39;</span><span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">22</span><span class="p">,</span> <span class="nx">sex</span><span class="o">:</span> <span class="s1">&#39;male&#39;</span><span class="p">,</span> <span class="nx">salary</span><span class="o">:</span> <span class="mi">6000</span><span class="p">}</span>
</span><span class="line"><span class="p">];</span>
</span><span class="line">
</span><span class="line"><span class="kd">var</span> <span class="nx">totalSalary</span> <span class="o">=</span> <span class="nx">users</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">el</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">el</span><span class="p">.</span><span class="nx">salary</span><span class="p">;</span> <span class="p">})</span>
</span><span class="line">                       <span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span><span class="p">;</span> <span class="p">});</span>
</span><span class="line">
</span><span class="line"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Total salary = %d&quot;</span><span class="p">,</span> <span class="nx">totalSalary</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Как вы заметили, мы также использовали функцию <code>map</code> для того чтобы превратить наш массив в линейный, состоящий только лишь из зарплатной состовляющей. Теперь довольно просто поменять аккумулирующую функцию, на любой оператор, который нам подходит. Также мы можем это увидеть на диаграмме:</p>

<p><img src="https://github.com/Netflix/RxJava/wiki/images/rx-operators/scan.png" alt="Array reduce" /></p>

<p>Scan и reduce являются синонимами.</p>

<p>Но не все так радужно по поводу этого. Так как выше приведенные функции являются стандартами ecmascript 5, то есть ряд браузеров которые ще это не поддерживают. Особенно это касается Internet Explorer 7,8. Для того чтобы исправить эту проблему существуют своего рода ‘заплатки’ - полифилы. Если мы хотим использовать эти функции везде, то стоит подключить этот скрипт <a href="https://github.com/es-shims/es5-shim" target="_blank">es-5 shim</a>.</p>

<p>Из этих функций, также есть обертки типа <code>sum</code>, <code>every</code>, <code>some</code> - но они являются лишь производными от основных, так сказать упрощают написание кода в часто используемых моментах.</p>

<p>Вы также можете проверить ваш браузер на поддержку тех или иных фич, перейдя по <a href="http://kangax.github.io/es5-compat-table" target="_blank">ссылке</a>
А на сегодня все, до новых встреч :)</p>

<p>PS: Диаграммы, приведенные в данной статье честно заимствованы с <a href="https://github.com/Netflix/RxJava/wiki" target="_blank">wiki</a></p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Денис Стоянов</span></span>

      








  


<time datetime="2014-02-16T13:53:32+02:00" pubdate data-updated="true">Feb 16<span>th</span>, 2014</time>
      

<span class="categories">
  
    <a class='category' href='/categories/es-5/'>es-5</a>, <a class='category' href='/categories/javascript/'>javascript</a>, <a class='category' href='/categories/js/'>js</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2014/02/15/angularjs-introduction/" title="Previous Post: Введение в AngularJS">&laquo; Введение в AngularJS</a>
      
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/02/16/manipulation-with-array/">Манипуляции с массивами</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/02/15/angularjs-introduction/">Введение в AngularJS</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/xgrommx">@xgrommx</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'xgrommx',
            count: 10,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Денис Стоянов -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'xgrommx';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://xgrommx.github.io/blog/2014/02/16/manipulation-with-array/';
        var disqus_url = 'http://xgrommx.github.io/blog/2014/02/16/manipulation-with-array/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>











</body>
</html>
